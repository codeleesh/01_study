# 테스트 발표 정리



## 단위테스트

- 작은 코드 조각(단위)을 검증
- 빠르게 수행 가능
- 격리된 방식으로 처리



```
- 단위에 대한 정의는 하는 사람마다 다 다를 수 있음
- 소프트웨어 시스템의 작은 부분에 초점을 맞춘 저수준이라는 개념
- 다른 종류의 테스트보다 훨씬 빠르고 작음
- 단일 메서드에서 전체 클래스에 이르기 까지 다양함
```



## 통합과 고립(Sociable and Solitary)

- 협력 객체를 실제 객체로 사용하는지 Mock(가짜) 객체로 사용하는지에 따 라 테스트 구현이 달라짐



```
- 단위 테스트 작성 시 관계를 맺고있는 대상(협력 객체)이 있는 경우를 고려해야 함
- 협력 객체를 실제 객체로 사용하는지 Mock(가짜) 객체로 사용하는지에 따라 테스트 구현이 달라짐

> 통합 테스트의 통합(Integration)과는 다름 
> 단위의 정의를 논하기 앞서 테스트하는 단위가 통합(Sociable)되어야 하는지 고립(Solitary)되어야 하는지 먼저 고려해야 함
```



### Sociable Unit Test



### Solitary Unit Test (with Mock)



## Test Double

- 실제 객체 대신 사용되는 모든 종류의 객체에 대한 일반 용어 

- 즉, 실제 (예 : 클래스, 모듈 또는 함수)를 가짜 버전으로 대체한다는 의미



```
- 테스트 목적으로 실제 객체 대신 사용되는 모든 종류의 척도, 객체에 대한 일반 용어
- 즉, 실제 (예 : 클래스, 모듈 또는 함수)를 가짜 버전으로 대체한다는 의미입니다.
- 가짜 버전은 실제와 같은 것처럼 보이고 (동일한 메소드 호출에 대한 답변) 단위 테스트 시작시 스스로 정의한 미리 준비된 답변으로 답변합니다.
- Test Double에는 종류가 여러가지가 있지만 대체 한다는 큰 의미에서는 같다고 할 수 있음
```



## Stubbing

- 테스트 동안 호출이 되면 미리 지정된 답변으로 응답
- 미리 프로그램된 것 외의 것에 대해서는 응답하지 않음

![https://techcourse-storage.s3.ap-northeast-2.amazonaws.com/2020-05-05T19%3A10%3A44image.png](https://techcourse-storage.s3.ap-northeast-2.amazonaws.com/2020-05-05T19%3A10%3A44image.png)

- Mockito
- MockitoExtension
- Spring을 활용한 Stubbing



## 협력 객체, 테스트 더블은 언제?

> 원래 stub을 하려면 세부 구현에 의존할 수 밖에 없는 것인가요?

네 맞습니다. 테스트 더블을 사용 할 경우 테스트에서 협력 객체의 세부 구현을 알아야 합니다.



### 테스트 대상이 협력 객체를 가질 때,

실제 객체를 사용하면 협력 객체의 행위를 **협력 객체 스스로가 정의**하며, 가짜 객체를 사용 하면 협력 객체의 행위를 **테스트가 정의** 합니다.



### 가짜 객체 특징

- 가짜 객체를 사용 할 경우 테스트 대상을 검증할 때 외부 요인(협력 객체)으로 부터 **철저히 격리**
- 하지만 테스트가 협력 객체의 **상세 구현을 알아야 함**

### 실제 객체 특징

- 실제 객체를 사용 할 경우 협력 객체의 상세 구현에 대해서 알 필요가 없음
- 하지만 **협력 객체**의 정상 동작 여부에 **영향을 받음**

### 테스트 코드를 작성 할 때

- 가짜 객체를 활용하면 실제 객체를 사용할 때 보다 조금 더 편하게 테스트를 작성할 수 있음
- 하지만 상세 구현에 의존하는 테스트가 될 수 있음

### 추천하는 방법

- 우선 TDD를 연습할 때 **가급적이면 실제 객체를 활용**하는 것을 우선으로 진행
- 테스트 작성이 어렵거나 흐름이 잘 이어지지 않는다면 테스트 더블을 활용하는 방법으로 접근하시는 것을 추천



### Stub



### Fake





# Test Driven Development(테스트 주도 개발, TDD)

- 위 그림을 통해 확인할 수 있듯이 **프로덕션 코드(Production Code)** 프로그램 구현을 담당하는 부분으로 사용자가 실제로 사용하는 소스 코드를 의미한다.
- **테스트 코드(test code)** 는 프로덕션 코드가 정상적으로 동작하는지를 확인하는 코드이다.

## TDD란?

- TDD = TFD(Test First Development) + 리팩토링

- TDD란 프로그래밍 의사결정과 피드백 사이의 간극을 의식하고 이를 제어하는 기술이다. - 켄트벡, Test Driven Development by Example 중
- TDD의 아이러니 중 하나는 테스트 기술이 아니라는 점이다. TDD는 분석 기술이며, 설계 기술이기도 하다. - 켄트벡, Test Driven Development by Example 중

## TDD를 하는 이유

- 디버깅 시간을 줄여준다.
- 동작하는 문서 역할을 한다.
- 변화에 대한 두려움을 줄여준다.

## TDD 사이클

![tdd cycle](https://articles.tbscg.com/wp-content/uploads/2015/11/tdd-cycle.png)

- 실패하는 테스트를 구현한다.
- 테스트가 성공하도록 프로덕션 코드를 구현한다.
- 프로덕션 코드와 테스트 코드를 리팩토링한다.

## TDD 원칙

- 원칙 1 - 실패하는 단위 테스트를 작성할 때까지 프로덕션 코드(production code)를 작성하지 않는다.
- 원칙 2 - 컴파일은 실패하지 않으면서 실행이 실패하는 정도로만 단위 테스트를 작성한다.
- 원칙 3 - 현재 실패하는 테스트를 통과할 정도로만 실제 코드를 작성한다.